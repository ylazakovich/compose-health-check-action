services:
  main:
    image: busybox:1.37
    stop_grace_period: 1s
    command: >
      sh -c "
        echo 'main started';
        touch /tmp/ready;
        exec tail -f /dev/null
      "
    healthcheck:
      test: ["CMD-SHELL", "test -f /tmp/ready"]
      interval: 200ms
      timeout: 200ms
      retries: 20
      start_period: 0s

  ghost:
    image: busybox:1.37
    stop_grace_period: 1s
    command: ["sh", "-c", "exec tail -f /dev/null"]
